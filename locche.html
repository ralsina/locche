<html>
<head>
<title>Locche!</title>
<link type="text/css" rel="stylesheet" href="http://cdn.jsdelivr.net/codemirror/3.14.0/codemirror.css" />

<script type="text/javascript" src="http://cdn.jsdelivr.net/jquery/1.10.2/jquery-1.10.2.js">
<script type="text/javascript" src="http://cdn.jsdelivr.net/jquery/1.10.2/jquery-1.10.2.min.js">

<script type="text/javascript" src="http://cdn.jsdelivr.net/codemirror/3.14.0/codemirror.js"></script>
<script type="text/javascript" src="http://cdn.jsdelivr.net/codemirror/3.14.0/codemirror.min.js"></script>

</head>
<body>
<h1>Locche!</h1>
<textarea id="thisislocche" cols="80" rows="20" style="display: none;"></textarea>
<button onCLick="do_paste()">Paste!</button>
<script>
var pastedata = 'PASTEDATA';
var markup = document.documentElement.innerHTML;
$('#thisislocche').val(markup);

var editor = CodeMirror(document.body, {
    value: pastedata == 'PASTEDATA' ? '' : pastedata
});

function do_paste() {
    // Get the value from the editor and "save it"
    data = editor.getDoc().getValue();
    $('#thisislocche').val($('#thisislocche').val().replace('PASTEDATA', data))
    bdata = window.btoa($('#thisislocche').val())
    window.location = 'data:text/html;base64,'+ bdata
}


</script>
</body>
</html>
